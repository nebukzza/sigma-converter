|rules///proxy/proxy_telegram_api.yml
|description
| Detects suspicious requests to Telegram API without the usual Telegram User-Agent

||-
|rules///proxy/proxy_ursnif_malware.yml
|description
| Detects download of Ursnif malware done by dropper documents.

||-
|rules///proxy/proxy_ursnif_malware.yml
|description
| Detects Ursnif C2 traffic.

||-
|rules///proxy/proxy_ua_suspicious.yml
|description
| Detects suspicious malformed user agent strings in proxy logs

||-
|rules///proxy/proxy_cobalt_onedrive.yml
|description
| Detects Malleable OneDrive Profile

||-
|rules///proxy/proxy_ios_implant.yml
|description
| Detects URL pattern used by iOS Implant

||-
|rules///proxy/proxy_ua_cryptominer.yml
|description
| Detects suspicious user agent strings used by crypto miners in proxy logs

||-
|rules///proxy/proxy_susp_flash_download_loc.yml
|description
| Detects a flashplayer update from an unofficial location

||-
|rules///proxy/proxy_raw_paste_service_access.yml
|description
| Detects direct access to raw pastes in different paste services often used by malware in their second stages to download malicious code in encrypted or encoded form

||-
|rules///proxy/proxy_download_susp_tlds_whitelist.yml
|description
| Detects executable downloads from suspicious remote systems

||-
|rules///proxy/proxy_powershell_ua.yml
|description
| Detects Windows PowerShell Web Access

||-
|rules///proxy/proxy_chafer_malware.yml
|description
| Detects HTTP requests used by Chafer malware

||-
|rules///proxy/proxy_cobalt_ocsp.yml
|description
| Detects Malleable (OCSP) Profile with Typo (OSCP) in URL

||-
|rules///proxy/proxy_cobalt_amazon.yml
|description
| Detects Malleable Amazon Profile

||-
|rules///proxy/proxy_download_susp_tlds_blacklist.yml
|description
| Detects download of certain file types from hosts in suspicious TLDs

||-
|rules///proxy/proxy_ua_hacktool.yml
|description
| Detects suspicious user agent strings user by hack tools in proxy logs

||-
|rules///proxy/proxy_downloadcradle_webdav.yml
|description
| Detects WebDav DownloadCradle

||-
|rules///proxy/proxy_ua_malware.yml
|description
| Detects suspicious user agent strings used by malware in proxy logs

||-
|rules///proxy/proxy_ua_frameworks.yml
|description
| Detects suspicious user agent strings used by exploit / pentest framworks like Metasploit in proxy logs

||-
|rules///proxy/proxy_download_susp_dyndns.yml
|description
| Detects download of certain file types from hosts with dynamic DNS names (selected list)

||-
|rules///proxy/proxy_empty_ua.yml
|description
| Detects suspicious empty user agent strings in proxy logs

||-
|rules///proxy/proxy_ua_bitsadmin_susp_tld.yml
|description
| Detects Bitsadmin connections to domains with uncommon TLDs - https
|//twitter.com/jhencinski/status/1102695118455349248 - https|-
|rules///proxy/proxy_ua_apt.yml
|description
| Detects suspicious user agent strings used in APT malware in proxy logs

||-
|rules///proxy/proxy_apt40.yml
|description
| Detects suspicious user agent string of APT40 Dropbox tool

||-
|rules///web/web_multiple_suspicious_resp_codes_single_source.yml
|description
| Detects possible exploitation activity or bugs in a web application

||-
|rules///web/web_pulsesecure_cve-2019-11510.yml
|description
| Detects CVE-2019-11510 exploitation attempt - URI contains Guacamole

||-
|rules///web/web_citrix_cve_2019_19781_exploit.yml
|description
| Detects CVE-2019-19781 exploitation attempt against Citrix Netscaler
| Application Delivery Controller and Citrix Gateway Attack
|-
|rules///web/web_apache_threading_error.yml
|description
| Detects an issue in apache logs that reports threading related errors

||-
|rules///web/web_cve_2018_2894_weblogic_exploit.yml
|description
| Detects access to a webshell droped into a keytore folder on the WebLogic server

||-
|rules///web/web_apache_segfault.yml
|description
| Detects a segmentation fault error message caused by a creashing apacke worker process

||-
|rules///web/web_webshell_keyword.yml
|description
| Detects webshells that use GET requests by keyword searches in URL strings

||-
|rules///web/web_source_code_enumeration.yml
|description
| Detects source code enumeration that use GET requests by keyword searches in URL strings

||-
|rules///network/net_dns_c2_detection.yml
|description
| Normally
| DNS logs contain a limited amount of different dns queries for a single domain. This rule detects a high amount of queries for a single domain|-
|rules///network/net_susp_network_scan.yml
|description
| Detects many failed connection attempts to different ports or hosts

||-
|rules///network/net_susp_network_scan.yml
|description
| Detects many failed connection attempts to different ports or hosts

||-
|rules///network/net_susp_dns_txt_exec_strings.yml
|description
| Detects strings used in command execution in DNS TXT Answer

||-
|rules///network/net_mal_dns_cobaltstrike.yml
|description
| Detects suspicious DNS queries known from Cobalt Strike beacons

||-
|rules///network/net_susp_dns_b64_queries.yml
|description
| Detects suspicious DNS queries using base64 encoding

||-
|rules///network/net_susp_telegram_api.yml
|description
| Detects suspicious DNS queries to api.telegram.org used by Telegram Bots of any kind

||-
|rules///compliance/cleartext_protocols.yml
|description
| Ensure that all account usernames and authentication credentials are transmitted across networks using encrypted channels. Ensure that an encryption is used for all sensitive information in transit. Ensure that an encrypted channels is used  for all administrative account access.

||-
|rules///compliance/cleartext_protocols.yml
|description
| Ensure that all account usernames and authentication credentials are transmitted across networks using encrypted channels. Ensure that an encryption is used for all sensitive information in transit. Ensure that an encrypted channels is used  for all administrative account access.

||-
|rules///compliance/group_modification_logging.yml
|description
| "Configure systems to issue a log entry and alert when an account is added to or removed from any group assigned administrative privileges. Sigma detects Event ID 4728 indicates a \u2018Member is added to a Security Group\u2019. Event ID 4729 indicates a \u2018Member is removed from a Security enabled-group\u2019. Event ID 4730 indicates a\u2018Security Group is deleted\u2019. The case is not applicable for Unix OS. Supported OS - Windows 2008 R2 and 7
| Windows 2012 R2 and 8.1|-
|rules///compliance/host_without_firewall.yml
|description
| Host Without Firewall. Alert means not complied. Sigma for Qualys vulnerability scanner. Scan type - Vulnerability Management.

||-
|rules///compliance/workstation_was_locked.yml
|description
| Automatically lock workstation sessions after a standard period of inactivity. The case is not applicable for Unix OS. Supported OS - Windows 2008 R2 and 7
| Windows 2012 R2 and 8.1|-
|rules///compliance/default_credentials_usage.yml
|description
| Before deploying any new asset
| change all default passwords to have values consistent with administrative level accounts. Sigma detects default credentials usage. Sigma for Qualys vulnerability scanner. Scan type - Vulnerability Management.
|-
|rules///apt/apt_tropictrooper.yml
|description
| Detects TropicTrooper activity
| an actor who targeted high-profile organizations in the energy and food and beverage sectors in Asia
|-
|rules///apt/apt_unidentified_nov_18.yml
|description
| A sigma rule detecting an unidetefied attacker who used phishing emails to target high profile orgs on November 2018. The Actor shares some TTPs with YYTRIUM/APT29 campaign in 2016.

||-
|rules///apt/apt_unidentified_nov_18.yml
|description
| A sigma rule detecting an unidetefied attacker who used phishing emails to target high profile orgs on November 2018. The Actor shares some TTPs with YYTRIUM/APT29 campaign in 2016.

||-
|rules///apt/apt_dragonfly.yml
|description
| Detects CrackMapExecWin Activity as Described by NCSC

||-
|rules///apt/apt_zxshell.yml
|description
| Detects a ZxShell start by the called and well-known function name

||-
|rules///apt/apt_emissarypanda_sep19.yml
|description
| Detects the execution of DLL side-loading malware used by threat group Emissary Panda aka APT27

||-
|rules///apt/apt_oceanlotus_registry.yml
|description
| Detects registry keys created in OceanLotus (also known as APT32) attacks

||-
|rules///apt/apt_sofacy.yml
|description
| Detects Trojan loader acitivty as used by APT28

||-
|rules///apt/apt_turla_namedpipes.yml
|description
| Detects a named pipe used by Turla group samples

||-
|rules///apt/apt_equationgroup_lnx.yml
|description
| Detects suspicious shell commands used in various Equation Group scripts and tools

||-
|rules///apt/apt_gallium.yml
|description
| Detects artefacts associated with activity group GALLIUM - Microsoft Threat Intelligence Center indicators released in December 2019.

||-
|rules///apt/apt_gallium.yml
|description
| Detects artefacts associated with activity group GALLIUM - Microsoft Threat Intelligence Center indicators released in December 2019.

||-
|rules///apt/apt_chafer_mar18.yml
|description
| Detects Chafer activity attributed to OilRig as reported in Nyotron report in March 2018

||-
|rules///apt/apt_chafer_mar18.yml
|description
| Detects Chafer activity attributed to OilRig as reported in Nyotron report in March 2018

||-
|rules///apt/apt_chafer_mar18.yml
|description
| Detects Chafer activity attributed to OilRig as reported in Nyotron report in March 2018

||-
|rules///apt/apt_chafer_mar18.yml
|description
| Detects Chafer activity attributed to OilRig as reported in Nyotron report in March 2018

||-
|rules///apt/apt_judgement_panda_gtr19.yml
|description
| Detects Judgement Panda activity as described in Global Threat Report 2019 by Crowdstrike

||-
|rules///apt/apt_equationgroup_c2.yml
|description
| Detects communication to C2 servers mentioned in the operational notes of the ShadowBroker leak of EquationGroup C2 tools

||-
|rules///apt/apt_empiremonkey.yml
|description
| Detects EmpireMonkey APT reported Activity

||-
|rules///apt/apt_cloudhopper.yml
|description
| Detects suspicious file execution by wscript and cscript

||-
|rules///apt/apt_turla_service_png.yml
|description
| This method detects malicious services mentioned in Turla PNG dropper report by NCC Group in November 2018

||-
|rules///apt/apt_hurricane_panda.yml
|description
| Detects Hurricane Panda Activity

||-
|rules///apt/apt_wocao.yml
|description
| Detects activity mentioned in Operation Wocao report

||-
|rules///apt/apt_wocao.yml
|description
| Detects activity mentioned in Operation Wocao report

||-
|rules///apt/apt_ta17_293a_ps.yml
|description
| Detects renamed SysInternals tool execution with a binary named ps.exe as used by Dragonfly APT group and documented in TA17-293A report

||-
|rules///apt/apt_carbonpaper_turla.yml
|description
| This method detects a service install of malicious services mentioned in Carbon Paper - Turla report by ESET

||-
|rules///apt/crime_fireball.yml
|description
| Detects Archer malware invocation via rundll32

||-
|rules///apt/apt_stonedrill.yml
|description
| This method detects a service install of the malicious Microsoft Network Realtime Inspection Service service described in StoneDrill report by Kaspersky

||-
|rules///apt/apt_equationgroup_dll_u_load.yml
|description
| Detects a specific tool and export used by EquationGroup

||-
|rules///apt/apt_elise.yml
|description
| Detects Elise backdoor acitivty as used by APT32

||-
|rules///apt/apt_babyshark.yml
|description
| Detects activity that could be related to Baby Shark malware

||-
|rules///apt/apt_bear_activity_gtr19.yml
|description
| Detects Russian group activity as described in Global Threat Report 2019 by Crowdstrike

||-
|rules///apt/apt_slingshot.yml
|description
| Detects the deactivation of the Scheduled defragmentation task as seen by Slingshot APT group

||-
|rules///apt/apt_slingshot.yml
|description
| Detects the deactivation of the Scheduled defragmentation task as seen by Slingshot APT group

||-
|rules///apt/apt_apt29_thinktanks.yml
|description
| This method detects a suspicious powershell command line combination as used by APT29 in a campaign against US think tanks

||-
|rules///apt/apt_pandemic.yml
|description
| Detects Pandemic Windows Implant

||-
|rules///apt/apt_pandemic.yml
|description
| Detects Pandemic Windows Implant

||-
|rules///linux/lnx_susp_named.yml
|description
| Detects suspicious DNS error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts

||-
|rules///linux/lnx_shell_clear_cmd_history.yml
|description
| Clear command history in linux which is used for defense evasion.

||-
|rules///linux/lnx_shellshock.yml
|description
| Detects shellshock expressions in log files

||-
|rules///linux/lnx_ssh_cve_2018_15473.yml
|description
| Detects exploitation attempt using public exploit code for CVE-2018-15473

||-
|rules///linux/lnx_susp_ssh.yml
|description
| Detects suspicious SSH / SSHD error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts

||-
|rules///linux/lnx_buffer_overflows.yml
|description
| Detects buffer overflow attempts in Unix system log files

||-
|rules///linux/lnx_susp_vsftp.yml
|description
| Detects suspicious VSFTPD error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts

||-
|rules///linux/lnx_shell_susp_rev_shells.yml
|description
| Detects suspicious shell commands or program code that may be exected or used in command line to establish a reverse shell

||-
|rules///linux/lnx_shell_susp_commands.yml
|description
| Detects suspicious shell commands used in various exploit codes (see references)

||-
|rules///linux/lnx_susp_failed_logons_single_source.yml
|description
| Detects suspicious failed logins with different user accounts from a single source system

||-
|rules///linux/lnx_sudo_cve_2019_14287.yml
|description
| Detects users trying to exploit sudo vulnerability reported in CVE-2019-14287

||-
|rules///linux/lnx_sudo_cve_2019_14287.yml
|description
| Detects users trying to exploit sudo vulnerability reported in CVE-2019-14287

||-
|rules///linux/lnx_shell_priv_esc_prep.yml
|description
| Detects suspicious shell commands indicating the information gathering phase as preparation for the Privilege Escalation.

||-
|rules///linux/lnx_susp_jexboss.yml
|description
| Detects suspicious command sequence that JexBoss

||-
|rules///linux/lnx_shell_susp_log_entries.yml
|description
| Detects suspicious log entries in Linux log files

||-
|rules///linux/lnx_clamav.yml
|description
| Detects relevant ClamAV messages

||-
|rules///application/appframework_ruby_on_rails_exceptions.yml
|description
| Detects suspicious Ruby on Rails exceptions that could indicate exploitation attempts

||-
|rules///application/appframework_spring_exceptions.yml
|description
| Detects suspicious Spring framework exceptions that could indicate exploitation attempts

||-
|rules///application/app_sqlinjection_errors.yml
|description
| Detects SQL error messages that indicate probing for an injection attack

||-
|rules///application/appframework_django_exceptions.yml
|description
| Detects suspicious Django web application framework exceptions that could indicate exploitation attempts

||-
|rules///application/app_python_sql_exceptions.yml
|description
| Generic rule for SQL exceptions in Python according to PEP 249

||-
|rules///windows/other/win_tool_psexec.yml
|description
| Detects PsExec service installation and execution events (service and Sysmon)

||-
|rules///windows/other/win_tool_psexec.yml
|description
| Detects PsExec service installation and execution events (service and Sysmon)

||-
|rules///windows/other/win_rare_schtask_creation.yml
|description
| This rule detects rare scheduled task creations. Typically software gets installed on multiple systems and not only on a few. The aggregation and count function selects tasks with rare names.

||-
|rules///windows/other/win_wmi_persistence.yml
|description
| Detects suspicious WMI event filter and command line event consumer based on event id 5861 and 5859 (Windows 10
| 2012 and higher)
|-
|rules///windows/malware/win_mal_ryuk.yml
|description
| Detects Ryuk Ransomware command lines

||-
|rules///windows/malware/av_webshell.yml
|description
| Detects a highly relevant Antivirus alert that reports a web shell

||-
|rules///windows/malware/av_relevant_files.yml
|description
| Detects an Antivirus alert in a highly relevant file path or with a relevant file name

||-
|rules///windows/malware/av_exploiting.yml
|description
| Detects a highly relevant Antivirus alert that reports an exploitation framework

||-
|rules///windows/malware/av_password_dumper.yml
|description
| Detects a highly relevant Antivirus alert that reports a password dumper

||-
|rules///windows/malware/win_mal_ursnif.yml
|description
| Detects new registry key created by Ursnif malware.

||-
|rules///windows/powershell/powershell_downgrade_attack.yml
|description
| Detects PowerShell downgrade attack by comparing the host versions with the actually used engine version 2.0

||-
|rules///windows/powershell/powershell_suspicious_download.yml
|description
| Detects suspicious PowerShell download command

||-
|rules///windows/powershell/powershell_suspicious_keywords.yml
|description
| Detects keywords that could indicate the use of some PowerShell exploitation framework

||-
|rules///windows/powershell/powershell_malicious_commandlets.yml
|description
| Detects Commandlet names from well-known PowerShell exploitation frameworks

||-
|rules///windows/powershell/powershell_ntfs_ads_access.yml
|description
| Detects writing data into NTFS alternate data streams from powershell. Needs Script Block Logging.

||-
|rules///windows/powershell/powershell_prompt_credentials.yml
|description
| Detects PowerShell calling a credential prompt

||-
|rules///windows/powershell/powershell_exe_calling_ps.yml
|description
| Detects PowerShell called from an executable by the version mismatch method

||-
|rules///windows/powershell/powershell_suspicious_invocation_generic.yml
|description
| Detects suspicious PowerShell invocation command parameters

||-
|rules///windows/powershell/powershell_shellcode_b64.yml
|description
| Detects Base64 encoded Shellcode

||-
|rules///windows/powershell/powershell_malicious_keywords.yml
|description
| Detects keywords from well-known PowerShell exploitation frameworks

||-
|rules///windows/powershell/powershell_psattack.yml
|description
| Detects the use of PSAttack PowerShell hack tool

||-
|rules///windows/powershell/powershell_suspicious_invocation_specific.yml
|description
| Detects suspicious PowerShell invocation command parameters

||-
|rules///windows/powershell/powershell_data_compressed.yml
|description
| An adversary may compress data (e.g.
| sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network
|-
|rules///windows/powershell/powershell_winlogon_helper_dll.yml
|description
| Winlogon.exe is a Windows component responsible for actions at logon/logoff as well as the secure attention sequence (SAS) triggered by Ctrl-Alt-Delete. Registry entries in HKLM\Software[Wow6432Node]Microsoft\Windows NT\CurrentVersion\Winlogon\ and HKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\ are used to manage additional helper programs and functionalities that support Winlogon. Malicious modifications to these Registry keys may cause Winlogon to load and execute malicious DLLs and/or executables.

||-
|rules///windows/process_creation/win_wmi_persistence_script_event_consumer.yml
|description
| Detects WMI script event consumers

||-
|rules///windows/process_creation/win_susp_script_execution.yml
|description
| Detects suspicious file execution by wscript and cscript

||-
|rules///windows/process_creation/win_malware_ryuk.yml
|description
| Detects Ryuk ransomware activity

||-
|rules///windows/process_creation/win_powershell_xor_commandline.yml
|description
| Detects suspicious powershell process which includes bxor command
| alternatvide obfuscation method to b64 encoded commands.
|-
|rules///windows/process_creation/win_susp_powershell_parent_combo.yml
|description
| Detects suspicious powershell invocations from interpreters or unusual programs

||-
|rules///windows/process_creation/win_susp_compression_params.yml
|description
| Detects suspicious command line arguments of common data compression tools

||-
|rules///windows/process_creation/win_susp_wmi_execution.yml
|description
| Detects WMI executing suspicious commands

||-
|rules///windows/process_creation/win_impacket_lateralization.yml
|description
| Detects wmiexec/dcomexec/atexec/smbexec from Impacket framework

||-
|rules///windows/process_creation/win_susp_taskmgr_localsystem.yml
|description
| Detects the creation of taskmgr.exe process in context of LOCAL_SYSTEM

||-
|rules///windows/process_creation/win_kernel_and_3rd_party_drivers_exploits_token_stealing.yml
|description
| Detection of child processes spawned with SYSTEM privileges by parents with non-SYSTEM privileges and Medium integrity level

||-
|rules///windows/process_creation/win_powershell_amsi_bypass.yml
|description
| Detects Request to amsiInitFailed that can be used to disable AMSI Scanning

||-
|rules///windows/process_creation/win_susp_net_execution.yml
|description
| Detects execution of Net.exe
| whether suspicious or benign.
|-
|rules///windows/process_creation/win_workflow_compiler.yml
|description
| Detects invocation of Microsoft Workflow Compiler
| which may permit the execution of arbitrary unsigned code.
|-
|rules///windows/process_creation/win_malware_notpetya.yml
|description
| Detects NotPetya ransomware activity in which the extracted passwords are passed back to the main module via named pipe
| the file system journal of drive C is deleted and windows eventlogs are cleared using wevtutil
|-
|rules///windows/process_creation/win_psexesvc_start.yml
|description
| Detects a PsExec service start

||-
|rules///windows/process_creation/win_multiple_suspicious_cli.yml
|description
| Detects multiple suspicious process in a limited timeframe

||-
|rules///windows/process_creation/win_susp_gup.yml
|description
| Detects execution of the Notepad++ updater in a suspicious directory
| which is often used in DLL side-loading attacks
|-
|rules///windows/process_creation/win_susp_psr_capture_screenshots.yml
|description
| The psr.exe captures desktop screenshots and saves them on the local machine

||-
|rules///windows/process_creation/win_susp_process_creations.yml
|description
| Detects suspicious process starts on Windows systems based on keywords

||-
|rules///windows/process_creation/win_apt_bluemashroom.yml
|description
| Detects a suspicious DLL loading from AppData Local path as described in BlueMashroom report

||-
|rules///windows/process_creation/win_sdbinst_shim_persistence.yml
|description
| Detects installation of a new shim using sdbinst.exe. A shim can be used to load malicious DLLs into applications.

||-
|rules///windows/process_creation/win_susp_vssadmin_ntds_activity.yml
|description
| Detects suspicious commands that could be related to activity that uses volume shadow copy to steal and retrieve hashes from the NTDS.dit file remotely

||-
|rules///windows/process_creation/win_mmc_spawn_shell.yml
|description
| Detects a Windows command line executable started from MMC.

||-
|rules///windows/process_creation/win_susp_svchost.yml
|description
| Detects a suspicious svchost process start

||-
|rules///windows/process_creation/win_netsh_fw_add.yml
|description
| Allow Incoming Connections by Port or Application on Windows Firewall

||-
|rules///windows/process_creation/win_sysmon_driver_unload.yml
|description
| Detect possible Sysmon driver unload

||-
|rules///windows/process_creation/win_install_reg_debugger_backdoor.yml
|description
| Detects the registration of a debugger for a program that is available in the logon screen (sticky key backdoor).

||-
|rules///windows/process_creation/win_hack_secutyxploded.yml
|description
| Detects the execution of SecurityXploded Tools

||-
|rules///windows/process_creation/win_susp_powershell_enc_cmd.yml
|description
| Detects suspicious powershell process starts with base64 encoded commands (e.g. Emotet)

||-
|rules///windows/process_creation/win_susp_outlook_temp.yml
|description
| Detects a suspicious program execution in Outlook temp folder

||-
|rules///windows/process_creation/win_susp_powershell_hidden_b64_cmd.yml
|description
| Detects base64 encoded strings used in hidden malicious PowerShell command lines

||-
|rules///windows/process_creation/win_malware_wannacry.yml
|description
| Detects WannaCry ransomware activity

||-
|rules///windows/process_creation/win_powershell_download.yml
|description
| Detects a Powershell process that contains download commands in its command line string

||-
|rules///windows/process_creation/win_susp_dxcap.yml
|description
| Detects execution of of Dxcap.exe

||-
|rules///windows/process_creation/win_susp_openwith.yml
|description
| The OpenWith.exe executes other binary

||-
|rules///windows/process_creation/win_spn_enum.yml
|description
| Detects Service Principal Name Enumeration used for Kerberoasting

||-
|rules///windows/process_creation/win_hack_bloodhound.yml
|description
| Detects command line parameters used by Bloodhound and Sharphound hack tools

||-
|rules///windows/process_creation/win_malware_dtrack.yml
|description
| Detects specific process parameters as seen in DTRACK infections

||-
|rules///windows/process_creation/win_vul_java_remote_debugging.yml
|description
| Detects a JAVA process running with remote debugging allowing more than just localhost to connect

||-
|rules///windows/process_creation/win_malware_dridex.yml
|description
| Detects typical Dridex process patterns

||-
|rules///windows/process_creation/win_attrib_hiding_files.yml
|description
| Detects usage of attrib.exe to hide files from users.

||-
|rules///windows/process_creation/win_possible_applocker_bypass.yml
|description
| Detects execution of executables that can be used to bypass Applocker whitelisting

||-
|rules///windows/process_creation/win_renamed_binary.yml
|description
| Detects the execution of a renamed binary often used by attackers or malware leveraging new Sysmon OriginalFileName datapoint.

||-
|rules///windows/process_creation/win_susp_msoffice.yml
|description
| Downloads payload from remote server

||-
|rules///windows/process_creation/win_susp_msiexec_web_install.yml
|description
| Detects suspicious msiexec process starts with web addreses as parameter

||-
|rules///windows/process_creation/win_exploit_cve_2019_1378.yml
|description
| Detects exploitation attempt of privilege escalation vulnerability via SetupComplete.cmd and PartnerSetupComplete.cmd decribed in CVE-2019-1378

||-
|rules///windows/process_creation/win_susp_dnx.yml
|description
| Execute C# code located in the consoleapp folder

||-
|rules///windows/process_creation/win_office_spawn_exe_from_users_directory.yml
|description
| Detects an executable in the users directory started from Microsoft Word
| Excel|-
|rules///windows/process_creation/win_susp_sysprep_appdata.yml
|description
| Detects suspicious sysprep process start with AppData folder as target (as used by Trojan Syndicasec in Thrip report by Symantec)

||-
|rules///windows/process_creation/win_susp_userinit_child.yml
|description
| Detects a suspicious child process of userinit

||-
|rules///windows/process_creation/win_susp_bginfo.yml
|description
| Execute VBscript code that is referenced within the *.bgi file.

||-
|rules///windows/process_creation/win_susp_csc.yml
|description
| Detects a suspicious parent of csc.exe
| which could by a sign of payload delivery
|-
|rules///windows/process_creation/win_win10_sched_task_0day.yml
|description
| Detects Task Scheduler .job import arbitrary DACL write\par

||-
|rules///windows/process_creation/win_susp_powershell_empire_launch.yml
|description
| Detects suspicious powershell command line parameters used in Empire

||-
|rules///windows/process_creation/win_data_compressed_with_rar.yml
|description
| An adversary may compress data (e.g.
| sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network
|-
|rules///windows/process_creation/win_susp_outlook.yml
|description
| Detects EnableUnsafeClientMailRules used for Script Execution from Outlook

||-
|rules///windows/process_creation/win_malware_emotet.yml
|description
| Detects all Emotet like process executions that are not covered by the more generic rules

||-
|rules///windows/process_creation/win_encoded_frombase64string.yml
|description
| Detects a base64 encoded FromBase64String keyword in a process command line

||-
|rules///windows/process_creation/win_wmi_spwns_powershell.yml
|description
| Detects WMI spawning PowerShell

||-
|rules///windows/process_creation/win_susp_control_dll_load.yml
|description
| Detects suspicious Rundll32 execution from control.exe as used by Equation Group and Exploit Kits

||-
|rules///windows/process_creation/win_powersploit_empire_schtasks.yml
|description
| Detects the creation of a schtask via PowerSploit or Empire Default Configuration.

||-
|rules///windows/process_creation/win_susp_sysvol_access.yml
|description
| Detects Access to Domain Group Policies stored in SYSVOL

||-
|rules///windows/process_creation/win_exploit_cve_2015_1641.yml
|description
| Detects Winword starting uncommon sub process MicroScMgmt.exe as used in exploits for CVE-2015-1641

||-
|rules///windows/process_creation/win_network_sniffing.yml
|description
| Network sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection. An adversary may place a network interface into promiscuous mode to passively access data in transit over the network
| or use span ports to capture a larger amount of data.
|-
|rules///windows/process_creation/win_process_creation_bitsadmin_download.yml
|description
| Detects usage of bitsadmin downloading a file

||-
|rules///windows/process_creation/win_xsl_script_processing.yml
|description
| Extensible Stylesheet Language (XSL) files are commonly used to describe the processing and rendering of data within XML files
| rule detects when adversaries abuse this functionality to execute arbitrary files while potentially bypassing application whitelisting defenses
|-
|rules///windows/process_creation/win_cmdkey_recon.yml
|description
| Detects usage of cmdkey to look for cached credentials

||-
|rules///windows/process_creation/win_termserv_proc_spawn.yml
|description
| Detects a process spawned by the terminal service server process (this could be an indicator for an exploitation of CVE-2019-0708)

||-
|rules///windows/process_creation/win_susp_comsvcs_procdump.yml
|description
| Detects process memory dump via comsvcs.dll and rundll32

||-
|rules///windows/process_creation/win_powershell_suspicious_parameter_variation.yml
|description
| Detects suspicious PowerShell invocation with a parameter substring

||-
|rules///windows/process_creation/win_susp_whoami.yml
|description
| Detects the execution of whoami
| which is often used by attackers after exloitation / privilege escalation but rarely used by administrators
|-
|rules///windows/process_creation/win_proc_wrong_parent.yml
|description
| Detect suspicious parent processes of well-known Windows processes

||-
|rules///windows/process_creation/win_susp_run_locations.yml
|description
| Detects suspicious process run from unusual locations

||-
|rules///windows/process_creation/win_susp_execution_path_webserver.yml
|description
| Detects a suspicious program execution in a web service root folder (filter out false positives)

||-
|rules///windows/process_creation/win_susp_ps_appdata.yml
|description
| Detects a suspicious command line execution that invokes PowerShell with reference to an AppData folder

||-
|rules///windows/process_creation/win_rdp_hijack_shadowing.yml
|description
| null

||-
|rules///windows/process_creation/win_susp_fsutil_usage.yml
|description
| Detects suspicious parameters of fsutil (deleting USN journal
| configuring it with small size..). Might be used by ransomwares during the attack (seen by NotPetya and others)
|-
|rules///windows/process_creation/win_susp_commands_recon_activity.yml
|description
| Detects a set of commands often used in recon stages by different attack groups

||-
|rules///windows/process_creation/win_susp_schtask_creation.yml
|description
| Detects the creation of scheduled tasks in user session

||-
|rules///windows/process_creation/win_webshell_detection.yml
|description
| Detects certain command line parameters often used during reconnaissance activity via web shells

||-
|rules///windows/process_creation/win_susp_whoami_localsystem.yml
|description
| Detects the execution of whoami as LOCAL_SYSTEM
| often used after privilege escalation by attackers who want to evaluate the new user context
|-
|rules///windows/process_creation/win_netsh_port_fwd.yml
|description
| Detects netsh commands that configure a port forwarding

||-
|rules///windows/process_creation/win_service_execution.yml
|description
| Detects manual service execution (start) via system utilities

||-
|rules///windows/process_creation/win_susp_cdb.yml
|description
| Launch 64-bit shellcode from the x64_calc.wds file using cdb.exe.

||-
|rules///windows/process_creation/win_change_default_file_association.yml
|description
| When a file is opened
| the default program used to open the file (also called the file association or handler) is checked. File association selections are stored in the Windows Registry and can be edited by users|-
|rules///windows/process_creation/win_malware_script_dropper.yml
|description
| Detects wscript/cscript executions of scripts located in user directories

||-
|rules///windows/process_creation/win_susp_certutil_encode.yml
|description
| Detects suspicious a certutil command that used to encode files
| which is sometimes used for data exfiltration
|-
|rules///windows/process_creation/win_exploit_cve_2017_8759.yml
|description
| Detects Winword starting uncommon sub process csc.exe as used in exploits for CVE-2017-8759

||-
|rules///windows/process_creation/win_susp_squirrel_lolbin.yml
|description
| Detects Possible Squirrel Packages Manager as Lolbin

||-
|rules///windows/process_creation/win_office_shell.yml
|description
| Detects a Windows command line executable started from Microsoft Word
| Excel|-
|rules///windows/process_creation/win_powershell_b64_shellcode.yml
|description
| Detects Base64 encoded Shellcode

||-
|rules///windows/process_creation/win_malware_qbot.yml
|description
| Detects QBot like process executions

||-
|rules///windows/process_creation/win_local_system_owner_account_discovery.yml
|description
| Local accounts
| System Owner/User discovery using operating systems utilities
|-
|rules///windows/process_creation/win_susp_regsvr32_anomalies.yml
|description
| Detects various anomalies in relation to regsvr32.exe

||-
|rules///windows/process_creation/win_ransomware_shadowcopy.yml
|description
| Detects commands that delete all local volume shadow copies as used by different Ransomware families

||-
|rules///windows/process_creation/win_webshell_spawn.yml
|description
| Web servers that spawn shell processes could be the result of a successfully placed web shell or an other attack

||-
|rules///windows/process_creation/win_silenttrinity_stage_use.yml
|description
| Detects SILENTTRINITY stager use

||-
|rules///windows/process_creation/win_silenttrinity_stage_use.yml
|description
| Detects SILENTTRINITY stager use

||-
|rules///windows/process_creation/win_susp_copy_lateral_movement.yml
|description
| Detects a suspicious copy command from a remote C$ or ADMIN$ share

||-
|rules///windows/process_creation/win_susp_calc.yml
|description
| Detects suspicious use of calc.exe with command line parameters or in a suspicious directory
| which is likely caused by some PoC or detection evasion
|-
|rules///windows/process_creation/win_susp_rundll32_by_ordinal.yml
|description
| Detects suspicious calls of DLLs in rundll32.dll exports by ordinal

||-
|rules///windows/process_creation/win_malware_formbook.yml
|description
| Detects Formbook like process executions that inject code into a set of files in the System32 folder
| which executes a special command command line to delete the dropper from the AppData Temp folder. We avoid false positives by excluding all parent process with command line parameters.
|-
|rules///windows/process_creation/win_susp_powershell_empire_uac_bypass.yml
|description
| Detects some Empire PowerShell UAC bypass methods

||-
|rules///windows/process_creation/win_susp_procdump.yml
|description
| Detects suspicious uses of the SysInternals Procdump utility by using a special command line parameter in combination with the lsass.exe process. This way we're also able to catch cases in which the attacker has renamed the procdump executable.

||-
|rules///windows/process_creation/win_system_exe_anomaly.yml
|description
| Detects a Windows program executable started in a suspicious folder

||-
|rules///windows/process_creation/win_susp_execution_path.yml
|description
| Detects a suspicious exection from an uncommon folder

||-
|rules///windows/process_creation/win_hwp_exploits.yml
|description
| Detects suspicious Hangul Word Processor (Hanword) sub processes that could indicate an exploitation

||-
|rules///windows/process_creation/win_hack_rubeus.yml
|description
| Detects command line parameters used by Rubeus hack tool

||-
|rules///windows/process_creation/win_susp_iss_module_install.yml
|description
| Detects suspicious IIS native-code module installations via command line

||-
|rules///windows/process_creation/win_exploit_cve_2019_1388.yml
|description
| Detects an explotation attempt in which the UAC consent dialogue is used to invoke an Internet Explorer process running as LOCAL_SYSTEM

||-
|rules///windows/process_creation/win_susp_exec_folder.yml
|description
| Detects process starts of binaries from a suspicious folder

||-
|rules///windows/process_creation/win_susp_eventlog_clear.yml
|description
| Detects clearing or configuration of eventlogs uwing wevtutil. Might be used by ransomwares during the attack (seen by NotPetya and others)

||-
|rules///windows/process_creation/win_exploit_cve_2017_11882.yml
|description
| Detects exploits that use CVE-2017-11882 to start EQNEDT32.EXE and other sub processes like mshta.exe

||-
|rules///windows/process_creation/win_susp_certutil_command.yml
|description
| Detects a suspicious Microsoft certutil execution with sub commands like 'decode' sub command
| which is sometimes used to decode malicious code with the built-in certutil utility
|-
|rules///windows/process_creation/win_malware_trickbot_recon_activity.yml
|description
| Trickbot enumerates domain/network topology and executes certain commands automatically every few minutes. This detectors attempts to identify that activity based off a command rarely observed in an enterprise network.

||-
|rules///windows/process_creation/win_etw_trace_evasion.yml
|description
| Detects a command that clears or disables any ETW trace log which could indicate a logging evasion.

||-
|rules///windows/process_creation/win_renamed_paexec.yml
|description
| Detects execution of renamed paexec via imphash and executable product string

||-
|rules///windows/process_creation/win_control_panel_item.yml
|description
| Detects the use of a control panel item (.cpl) outside of the System32 folder

||-
|rules///windows/process_creation/win_mavinject_proc_inj.yml
|description
| Detects process injection using the signed Windows tool Mavinject32.exe

||-
|rules///windows/process_creation/win_susp_csc_folder.yml
|description
| Detects a suspicious execution of csc.exe
| which uses a source in a suspicious folder (e.g. AppData)
|-
|rules///windows/process_creation/win_susp_prog_location_process_starts.yml
|description
| Detects programs running in suspicious files system locations

||-
|rules///windows/process_creation/win_susp_tscon_localsystem.yml
|description
| Detects a tscon.exe start as LOCAL SYSTEM

||-
|rules///windows/process_creation/win_apt_mustangpanda.yml
|description
| Detects specific process parameters as used by Mustang Panda droppers

||-
|rules///windows/process_creation/win_cmstp_com_object_access.yml
|description
| Detects UAC Bypass Attempt Using Microsoft Connection Manager Profile Installer Autoelevate-capable COM Objects

||-
|rules///windows/process_creation/win_susp_ntdsutil.yml
|description
| Detects execution of ntdsutil.exe
| which can be used for various attacks against the NTDS database (NTDS.DIT)
|-
|rules///windows/process_creation/win_susp_codepage_switch.yml
|description
| Detects a code page switch in command line or batch scripts to a rare language

||-
|rules///windows/process_creation/win_encoded_iex.yml
|description
| Detects a base64 encoded IEX command string in a process command line

||-
|rules///windows/process_creation/win_susp_cli_escape.yml
|description
| Detects suspicious process that use escape characters

||-
|rules///windows/process_creation/win_bypass_squiblytwo.yml
|description
| Detects WMI SquiblyTwo Attack with possible renamed WMI by looking for imphash

||-
|rules///windows/process_creation/win_exploit_cve_2017_0261.yml
|description
| Detects Winword starting uncommon sub process FLTLDR.exe as used in exploits for CVE-2017-0261 and CVE-2017-0262

||-
|rules///windows/process_creation/win_susp_recon_activity.yml
|description
| Detects suspicious command line activity on Windows systems

||-
|rules///windows/process_creation/win_wmi_backdoor_exchange_transport_agent.yml
|description
| Detects a WMi backdoor in Exchange Transport Agents via WMi event filters

||-
|rules///windows/process_creation/win_susp_bcdedit.yml
|description
| Detects
| possibly|-
|rules///windows/process_creation/win_susp_ping_hex_ip.yml
|description
| Detects a ping command that uses a hex encoded IP address

||-
|rules///windows/process_creation/win_susp_taskmgr_parent.yml
|description
| Detects the creation of a process from Windows task manager

||-
|rules///windows/process_creation/win_shell_spawn_susp_program.yml
|description
| Detects a suspicious child process of a Windows shell

||-
|rules///windows/process_creation/win_netsh_packet_capture.yml
|description
| Detects capture a network trace via netsh.exe trace functionality

||-
|rules///windows/process_creation/win_plugx_susp_exe_locations.yml
|description
| Detects the execution of an executable that is typically used by PlugX for DLL side loading started from an uncommon location

||-
|rules///windows/process_creation/win_mshta_spawn_shell.yml
|description
| Detects a Windows command line executable started from MSHTA.

||-
|rules///windows/process_creation/win_lethalhta.yml
|description
| Detects MSHTA.EXE spwaned by SVCHOST described in report

||-
|rules///windows/process_creation/win_hktl_createminidump.yml
|description
| Detects the use of CreateMiniDump hack tool used to dump the LSASS process memory for credential extraction on the attacker's machine

||-
|rules///windows/process_creation/win_hktl_createminidump.yml
|description
| Detects the use of CreateMiniDump hack tool used to dump the LSASS process memory for credential extraction on the attacker's machine

||-
|rules///windows/process_creation/win_susp_cmd_http_appdata.yml
|description
| Detects a suspicious command line execution that includes an URL and AppData string in the command line parameters as used by several droppers (js/vbs > powershell)

||-
|rules///windows/process_creation/win_mal_adwind.yml
|description
| Detects javaw.exe in AppData folder as used by Adwind / JRAT

||-
|rules///windows/process_creation/win_mal_adwind.yml
|description
| Detects javaw.exe in AppData folder as used by Adwind / JRAT

||-
|rules///windows/process_creation/win_mal_adwind.yml
|description
| Detects javaw.exe in AppData folder as used by Adwind / JRAT

||-
|rules///windows/process_creation/win_susp_tscon_rdp_redirect.yml
|description
| Detects a suspicious RDP session redirect using tscon.exe

||-
|rules///windows/process_creation/win_susp_msiexec_cwd.yml
|description
| Detects suspicious msiexec process starts in an uncommon directory

||-
|rules///windows/process_creation/win_susp_firewall_disable.yml
|description
| Detects netsh commands that turns off the Windows firewall

||-
|rules///windows/process_creation/win_susp_double_extension.yml
|description
| Detects suspicious use of an .exe extension after a non-executable file extension like .pdf.exe
| a set of spaces or underlines to cloak the executable file in spear phishing campaigns
|-
|rules///windows/process_creation/win_renamed_binary_highly_relevant.yml
|description
| Detects the execution of a renamed binary often used by attackers or malware leveraging new Sysmon OriginalFileName datapoint.

||-
|rules///windows/process_creation/win_query_registry.yml
|description
| Adversaries may interact with the Windows Registry to gather information about the system
| configuration|-
|rules///windows/process_creation/win_susp_odbcconf.yml
|description
| Detects defence evasion attempt via odbcconf.exe execution to load DLL

||-
|rules///windows/process_creation/win_susp_svchost_no_cli.yml
|description
| It is extremely abnormal for svchost.exe to spawn without any CLI arguments and is normally observed when a malicious process spawns the process and injects code into the process memory space.

||-
|rules///windows/process_creation/win_powershell_dll_execution.yml
|description
| Detects PowerShell Strings applied to rundllas seen in PowerShdll.dll

||-
|rules///windows/process_creation/win_susp_devtoolslauncher.yml
|description
| The Devtoolslauncher.exe executes other binary

||-
|rules///windows/process_creation/win_netsh_port_fwd_3389.yml
|description
| Detects netsh commands that configure a port forwarding of port 3389 used for RDP

||-
|rules///windows/process_creation/win_susp_rasdial_activity.yml
|description
| Detects suspicious process related to rasdial.exe

||-
|rules///windows/process_creation/win_susp_rundll32_activity.yml
|description
| Detects suspicious process related to rundll32 based on arguments

||-
|rules///windows/sysmon/sysmon_stickykey_like_backdoor.yml
|description
| Detects the usage and installation of a backdoor that uses an option to register a malicious debugger for built-in tools that are accessible in the login screen

||-
|rules///windows/sysmon/sysmon_stickykey_like_backdoor.yml
|description
| Detects the usage and installation of a backdoor that uses an option to register a malicious debugger for built-in tools that are accessible in the login screen

||-
|rules///windows/sysmon/sysmon_cmstp_execution.yml
|description
| Detects various indicators of Microsoft Connection Manager Profile Installer execution

||-
|rules///windows/sysmon/sysmon_cmstp_execution.yml
|description
| Detects various indicators of Microsoft Connection Manager Profile Installer execution

||-
|rules///windows/sysmon/sysmon_susp_rdp.yml
|description
| Detects Non-Standard Tools Connecting to TCP port 3389 indicating possible lateral movement

||-
|rules///windows/sysmon/sysmon_malware_verclsid_shellcode.yml
|description
| Detects a process access to verclsid.exe that injects shellcode from a Microsoft Office application / VBA macro

||-
|rules///windows/sysmon/sysmon_susp_powershell_rundll32.yml
|description
| Detects PowerShell remote thread creation in Rundll32.exe

||-
|rules///windows/sysmon/sysmon_mimikatz_detection_lsass.yml
|description
| Detects process access to LSASS which is typical for Mimikatz (0x1000 PROCESS_QUERY_ LIMITED_INFORMATION
| 0x0400 PROCESS_QUERY_ INFORMATION "only old versions"|-
|rules///windows/sysmon/sysmon_ghostpack_safetykatz.yml
|description
| Detects possible SafetyKatz Behaviour

||-
|rules///windows/sysmon/sysmon_renamed_procdump.yml
|description
| Detects the execution of a renamed ProcDump executable often used by attackers or malware

||-
|rules///windows/sysmon/sysmon_hack_wce.yml
|description
| Detects the use of Windows Credential Editor (WCE)

||-
|rules///windows/sysmon/sysmon_hack_wce.yml
|description
| Detects the use of Windows Credential Editor (WCE)

||-
|rules///windows/sysmon/sysmon_sysinternals_eula_accepted.yml
|description
| Detects the usage of Sysinternals Tools due to accepteula key being added to Registry

||-
|rules///windows/sysmon/sysmon_sysinternals_eula_accepted.yml
|description
| Detects the usage of Sysinternals Tools due to accepteula key being added to Registry

||-
|rules///windows/sysmon/sysmon_wmi_susp_scripting.yml
|description
| Detects suspicious scripting in WMI Event Consumers

||-
|rules///windows/sysmon/sysmon_invoke_phantom.yml
|description
| Detects suspect access to svchost process memory such as that used by Invoke-Phantom to kill the winRM windows event logging service.

||-
|rules///windows/sysmon/sysmon_win_reg_persistence.yml
|description
| Detects persistence registry keys

||-
|rules///windows/sysmon/sysmon_powershell_network_connection.yml
|description
| Detects a Powershell process that opens network connections - check for suspicious target ports and target systems - adjust to your environment (e.g. extend filters with company's ip range')

||-
|rules///windows/sysmon/sysmon_tsclient_filewrite_startup.yml
|description
| Detects the usage of tsclient share to place a backdoor on the RDP source machine's startup folder

||-
|rules///windows/sysmon/sysmon_cobaltstrike_process_injection.yml
|description
| Detects a possible remote threat creation with certain characteristics which are typical for Cobalt Strike beacons

||-
|rules///windows/sysmon/sysmon_renamed_psexec.yml
|description
| Detects the execution of a renamed PsExec often used by attackers or malware

||-
|rules///windows/sysmon/sysmon_susp_driver_load.yml
|description
| Detects a driver load from a temporary directory

||-
|rules///windows/sysmon/sysmon_logon_scripts_userinitmprlogonscript.yml
|description
| Detects creation or execution of UserInitMprLogonScript persistence method

||-
|rules///windows/sysmon/sysmon_logon_scripts_userinitmprlogonscript.yml
|description
| Detects creation or execution of UserInitMprLogonScript persistence method

||-
|rules///windows/sysmon/sysmon_logon_scripts_userinitmprlogonscript.yml
|description
| Detects creation or execution of UserInitMprLogonScript persistence method

||-
|rules///windows/sysmon/sysmon_wmi_persistence_commandline_event_consumer.yml
|description
| Detects WMI command line event consumers

||-
|rules///windows/sysmon/sysmon_password_dumper_lsass.yml
|description
| Detects password dumper activity by monitoring remote thread creation EventID 8 in combination with the lsass.exe process as TargetImage. The process in field Process is the malicious program. A single execution can lead to hundreds of events.

||-
|rules///windows/sysmon/sysmon_lsass_memdump.yml
|description
| Detects process LSASS memory dump using procdump or taskmgr based on the CallTrace pointing to dbghelp.dll or dbgcore.dll for win10

||-
|rules///windows/sysmon/sysmon_dns_serverlevelplugindll.yml
|description
| Detects the installation of a plugin DLL via ServerLevelPluginDll parameter in Registry
| which can be used to execute code in context of the DNS server (restart required)
|-
|rules///windows/sysmon/sysmon_dns_serverlevelplugindll.yml
|description
| Detects the installation of a plugin DLL via ServerLevelPluginDll parameter in Registry
| which can be used to execute code in context of the DNS server (restart required)
|-
|rules///windows/sysmon/sysmon_susp_file_characteristics.yml
|description
| Detects Executables without FileVersion
|Description|-
|rules///windows/sysmon/sysmon_ads_executable.yml
|description
| Detects the creation of an ADS data stream that contains an executable (non-empty imphash)

||-
|rules///windows/sysmon/win_susp_winword_wmidll_load.yml
|description
| Detects DLL's Loaded Via Word Containing VBA Macros Executing WMI Commands

||-
|rules///windows/sysmon/sysmon_quarkspw_filedump.yml
|description
| Detects a dump file written by QuarksPwDump password dumper

||-
|rules///windows/sysmon/sysmon_uac_bypass_sdclt.yml
|description
| Detects changes to HKCU
|\Software\Classes\exefile\shell\runas\command\isolatedCommand
|-
|rules///windows/sysmon/sysmon_cactustorch.yml
|description
| Detects remote thread creation from CACTUSTORCH as described in references.

||-
|rules///windows/sysmon/sysmon_win_binary_susp_com.yml
|description
| Detects an executable in the Windows folder accessing suspicious domains

||-
|rules///windows/sysmon/sysmon_win_binary_github_com.yml
|description
| Detects an executable in the Windows folder accessing github.com

||-
|rules///windows/sysmon/sysmon_malware_backconnect_ports.yml
|description
| Detects programs that connect to typical malware back connect ports based on statistical analysis from two different sandbox system databases

||-
|rules///windows/sysmon/sysmon_wmi_event_subscription.yml
|description
| Detects creation of WMI event subscription persistence method

||-
|rules///windows/sysmon/sysmon_wmi_persistence_script_event_consumer_write.yml
|description
| Detects file writes of WMI script event consumer

||-
|rules///windows/sysmon/sysmon_rundll32_net_connections.yml
|description
| Detects a rundll32 that communicates with public IP addresses

||-
|rules///windows/sysmon/sysmon_svchost_dll_search_order_hijack.yml
|description
| IKEEXT and SessionEnv service
| as they call LoadLibrary on files that do not exist within C|-
|rules///windows/sysmon/sysmon_mal_namedpipes.yml
|description
| Detects the creation of a named pipe used by known APT malware

||-
|rules///windows/sysmon/sysmon_registry_persistence_key_linking.yml
|description
| Detects COM object hijacking via TreatAs subkey

||-
|rules///windows/sysmon/sysmon_susp_reg_persist_explorer_run.yml
|description
| Detects a possible persistence mechanism using RUN key for Windows Explorer and poiting to a suspicious folder

||-
|rules///windows/sysmon/sysmon_susp_prog_location_network_connection.yml
|description
| Detects programs with network connections running in suspicious files system locations

||-
|rules///windows/sysmon/sysmon_susp_image_load.yml
|description
| Detects Loading of samlib.dll
| WinSCard.dll from untypical process e.g. through process hollowing by Mimikatz
|-
|rules///windows/sysmon/sysmon_suspicious_keyboard_layout_load.yml
|description
| Detects the keyboard preload installation with a suspicious keyboard layout
| e.g. Chinese|-
|rules///windows/sysmon/sysmon_susp_download_run_key.yml
|description
| Detects the suspicious RUN keys created by software located in Download or temporary Outlook/Internet Explorer directories

||-
|rules///windows/sysmon/sysmon_susp_lsass_dll_load.yml
|description
| Detects a method to load DLL via LSASS process using an undocumented Registry key

||-
|rules///windows/sysmon/sysmon_webshell_creation_detect.yml
|description
| Posible webshell file creation on a static web site

||-
|rules///windows/sysmon/sysmon_powershell_exploit_scripts.yml
|description
| Detects the creation of known powershell scripts for exploitation

||-
|rules///windows/sysmon/sysmon_renamed_powershell.yml
|description
| Detects the execution of a renamed PowerShell often used by attackers or malware

||-
|rules///windows/sysmon/sysmon_rdp_reverse_tunnel.yml
|description
| Detects svchost hosting RDP termsvcs communicating with the loopback address and on TCP port 3389

||-
|rules///windows/sysmon/sysmon_uac_bypass_eventvwr.yml
|description
| Detects UAC bypass method using Windows event viewer

||-
|rules///windows/sysmon/sysmon_ssp_added_lsa_config.yml
|description
| Detects the addition of a SSP to the registry. Upon a reboot or API call
| SSP DLLs gain access to encrypted and plaintext passwords stored in Windows.
|-
|rules///windows/sysmon/sysmon_susp_run_key_img_folder.yml
|description
| Detects suspicious new RUN key element pointing to an executable in a suspicious folder

||-
|rules///windows/sysmon/sysmon_dhcp_calloutdll.yml
|description
| Detects the installation of a Callout DLL via CalloutDlls and CalloutEnabled parameter in Registry
| which can be used to execute code in context of the DHCP server (restart required)
|-
|rules///windows/sysmon/sysmon_mimikatz_trough_winrm.yml
|description
| Detects usage of mimikatz through WinRM protocol by monitoring access to lsass process by wsmprovhost.exe.

||-
|rules///windows/sysmon/sysmon_rdp_settings_hijack.yml
|description
| Detects changes to RDP terminal service sensitive settings

||-
|rules///windows/builtin/win_av_relevant_match.yml
|description
| This detection method points out highly relevant Antivirus events

||-
|rules///windows/builtin/win_susp_net_recon_activity.yml
|description
| Detects activity as "net user administrator /domain" and "net group domain admins /domain"

||-
|rules///windows/builtin/win_susp_rc4_kerberos.yml
|description
| Detects service ticket requests using RC4 encryption type

||-
|rules///windows/builtin/win_susp_sam_dump.yml
|description
| Detects suspicious SAM dump activity as cause by QuarksPwDump and other password dumpers

||-
|rules///windows/builtin/win_susp_time_modification.yml
|description
| Detect scenarios where a potentially unauthorized application or user is modifying the system time.

||-
|rules///windows/builtin/win_external_device.yml
|description
| Detects external diskdrives or plugged in USB devices

||-
|rules///windows/builtin/win_GPO_scheduledtasks.yml
|description
| Detect lateral movement using GPO scheduled task
| ususally used to deploy ransomware at scale
|-
|rules///windows/builtin/win_mal_creddumper.yml
|description
| This method detects well-known keywords of malicious services in the Windows System Eventlog

||-
|rules///windows/builtin/win_susp_failed_logon_reasons.yml
|description
| This method uses uncommon error codes on failed logons to determine suspicious activity and tampering with accounts that have been disabled or somehow restricted.

||-
|rules///windows/builtin/win_dcsync.yml
|description
| Detects Mimikatz DC sync security events

||-
|rules///windows/builtin/win_rdp_localhost_login.yml
|description
| RDP login with localhost source address may be a tunnelled login

||-
|rules///windows/builtin/win_svcctl_remote_service.yml
|description
| Detects remote remote service activity via remote access to the svcctl named pipe

||-
|rules///windows/builtin/win_account_discovery.yml
|description
| Detect priv users or groups recon based on 4661 eventid and known privileged users or groups SIDs

||-
|rules///windows/builtin/win_susp_sdelete.yml
|description
| Detects renaming of file while deletion with SDelete tool

||-
|rules///windows/builtin/win_pass_the_hash_2.yml
|description
| Detects the attack technique pass the hash which is used to move laterally inside the network

||-
|rules///windows/builtin/win_alert_ad_user_backdoors.yml
|description
| Detects scenarios where one can control another users or computers account without having to use their credentials.

||-
|rules///windows/builtin/win_susp_add_sid_history.yml
|description
| An attacker can use the SID history attribute to gain additional privileges.

||-
|rules///windows/builtin/win_susp_ntlm_auth.yml
|description
| Detects logons using NTLM
| which could be caused by a legacy source or attackers
|-
|rules///windows/builtin/win_admin_rdp_login.yml
|description
| Detect remote login by Administrator user depending on internal pattern

||-
|rules///windows/builtin/win_susp_add_domain_trust.yml
|description
| Addition of domains is seldom and should be verified for legitimacy.

||-
|rules///windows/builtin/win_user_creation.yml
|description
| Detects local user creation on windows servers
| which shouldn't happen in an Active Directory environment. Apply this Sigma Use Case on your windows server logs and not on your DC logs.
|-
|rules///windows/builtin/win_rare_schtasks_creations.yml
|description
| Detects rare scheduled tasks creations that only appear a few times per time frame and could reveal password dumpers
| backdoor installs or other types of malicious code
|-
|rules///windows/builtin/win_overpass_the_hash.yml
|description
| Detects successful logon with logon type 9 (NewCredentials) which matches the Overpass the Hash behavior of e.g Mimikatz's sekurlsa
||-
|rules///windows/builtin/win_susp_security_eventlog_cleared.yml
|description
| Some threat groups tend to delete the local 'Security' Eventlog using certain utitlities

||-
|rules///windows/builtin/win_susp_eventlog_cleared.yml
|description
| One of the Windows Eventlogs has been cleared. e.g. caused by "wevtutil cl" command execution

||-
|rules///windows/builtin/win_account_backdoor_dcsync_rights.yml
|description
| backdooring domain object to grant the rights associated with DCSync to a regular user or machine account using Powerview\Add-DomainObjectAcl DCSync Extended Right cmdlet
| will allow to re-obtain the pwd hashes of any user/computer
|-
|rules///windows/builtin/win_susp_dhcp_config.yml
|description
| This rule detects a DHCP server in which a specified Callout DLL (in registry) was loaded

||-
|rules///windows/builtin/win_susp_mshta_execution.yml
|description
| Detection for mshta.exe suspicious execution patterns sometimes involving file polyglotism

||-
|rules///windows/builtin/win_rdp_potential_cve-2019-0708.yml
|description
| Detect suspicious error on protocol RDP
| potential CVE-2019-0708
|-
|rules///windows/builtin/win_hack_smbexec.yml
|description
| Detects the use of smbexec.py tool by detecting a specific service installation

||-
|rules///windows/builtin/win_susp_dns_config.yml
|description
| This rule detects a DNS server error in which a specified plugin DLL (in registry) could not be loaded

||-
|rules///windows/builtin/win_mal_service_installs.yml
|description
| Detects known malicious service installs that only appear in cases of lateral movement
| credential dumping and other suspicious activity
|-
|rules///windows/builtin/win_alert_ruler.yml
|description
| This events that are generated when using the hacktool Ruler by Sensepost

||-
|rules///windows/builtin/win_alert_mimikatz_keywords.yml
|description
| This method detects mimikatz keywords in different Eventlogs (some of them only appear in older Mimikatz version that are however still used by different threat groups)

||-
|rules///windows/builtin/win_susp_raccess_sensitive_fext.yml
|description
| Detects known sensitive file extensions

||-
|rules///windows/builtin/win_alert_active_directory_user_control.yml
|description
| Detects scenario where if a user is assigned the SeEnableDelegationPrivilege right in Active Directory it would allow control of other AD user objects.

||-
|rules///windows/builtin/win_susp_dhcp_config_failed.yml
|description
| This rule detects a DHCP server error in which a specified Callout DLL (in registry) could not be loaded

||-
|rules///windows/builtin/win_disable_event_logging.yml
|description
| 'Detects scenarios where system auditing (ie
| windows event log auditing) is disabled. This may be used in a scenario where an entity would want to bypass local logging to evade detection when windows event logging is enabled and reviewed. Also|-
|rules///windows/builtin/win_rare_service_installs.yml
|description
| Detects rare service installs that only appear a few times per time frame and could reveal password dumpers
| backdoor installs or other types of malicious services
|-
|rules///windows/builtin/win_susp_interactive_logons.yml
|description
| Detects interactive console logons to

||-
|rules///windows/builtin/win_susp_dsrm_password_change.yml
|description
| The Directory Service Restore Mode (DSRM) account is a local administrator account on Domain Controllers. Attackers may change the password to gain persistence.

||-
|rules///windows/builtin/win_net_ntlm_downgrade.yml
|description
| Detects post exploitation using NetNTLM downgrade attacks

||-
|rules///windows/builtin/win_net_ntlm_downgrade.yml
|description
| Detects post exploitation using NetNTLM downgrade attacks

||-
|rules///windows/builtin/win_susp_msmpeng_crash.yml
|description
| This rule detects a suspicious crash of the Microsoft Malware Protection Engine

||-
|rules///windows/builtin/win_mal_wceaux_dll.yml
|description
| Detects wceaux.dll access while WCE pass-the-hash remote command execution on source host

||-
|rules///windows/builtin/win_susp_psexec.yml
|description
| detects execution of psexec or paexec with renamed service name
| this rule helps to filter out the noise if psexec is used for legit purposes or if attacker uses a different psexec client other than sysinternal one
|-
|rules///windows/builtin/win_susp_backup_delete.yml
|description
| Detects backup catalog deletions

||-
|rules///windows/builtin/win_audit_cve.yml
|description
| Detects events generated by Windows to indicate the exploitation of a known vulnerability (e.g. CVE-2020-0601)

||-
|rules///windows/builtin/win_susp_kerberos_manipulation.yml
|description
| This method triggers on rare Kerberos Failure Codes caused by manipulations of Kerberos messages

||-
|rules///windows/builtin/win_alert_enable_weak_encryption.yml
|description
| Detects scenario where weak encryption is enabled for a user profile which could be used for hash/password cracking.

||-
|rules///windows/builtin/win_susp_rottenpotato.yml
|description
| Detects logon events that have characteristics of events generated during an attack with RottenPotato and the like

||-
|rules///windows/builtin/win_lm_namedpipe.yml
|description
| This detection excludes known namped pipes accessible remotely and notify on newly observed ones
| may help to detect lateral movement and remote exec using named pipes
|-
|rules///windows/builtin/win_susp_wmi_login.yml
|description
| Detection of logins performed with WMI

||-
|rules///windows/builtin/win_usb_device_plugged.yml
|description
| Detects plugged USB devices

||-
|rules///windows/builtin/win_susp_codeintegrity_check_failure.yml
|description
| Code integrity failures may indicate tampered executables.

||-
|rules///windows/builtin/win_impacket_secretdump.yml
|description
| Detect AD credential dumping using impacket secretdump HKTL

||-
|rules///windows/builtin/win_pass_the_hash.yml
|description
| Detects the attack technique pass the hash which is used to move laterally inside the network

||-
|rules///windows/builtin/win_admin_share_access.yml
|description
| Detects access to $ADMIN share

||-
|rules///windows/builtin/win_user_added_to_local_administrators.yml
|description
| This rule triggers on user accounts that are added to the local Administrators group
| which could be legitimate activity or a sign of privilege escalation activity
|-
|rules///windows/builtin/win_susp_lsass_dump.yml
|description
| Detects process handle on LSASS process with certain access mask and object type SAM_DOMAIN

||-
|rules///windows/builtin/win_rdp_reverse_tunnel.yml
|description
| Detects svchost hosting RDP termsvcs communicating with the loopback address and on TCP port 3389

||-
|rules///windows/builtin/win_atsvc_task.yml
|description
| Detects remote task creation via at.exe or API interacting with ATSVC namedpipe

||-
|rules///windows/builtin/win_rdp_bluekeep_poc_scanner.yml
|description
| Detects the use of a scanner by zerosum0x0 that discovers targets vulnerable to  CVE-2019-0708 RDP RCE aka BlueKeep

||-
|rules///windows/builtin/win_alert_lsass_access.yml
|description
| Detects Access to LSASS Process

||-
|rules///windows/builtin/win_susp_failed_logons_single_source.yml
|description
| Detects suspicious failed logins with different user accounts from a single source system

||-
|rules///windows/builtin/win_susp_failed_logons_single_source.yml
|description
| Detects suspicious failed logins with different user accounts from a single source system

||-
